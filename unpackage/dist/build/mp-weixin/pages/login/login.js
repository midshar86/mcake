"use strict";const e=require("../../common/vendor.js"),s=require("../../utils/req.js"),o=require("../../store/user.js");if(!Array){(e.resolveComponent("up-button")+e.resolveComponent("up-toast"))()}Math||((()=>"../../uni_modules/uview-plus/components/u-button/u-button.js")+(()=>"../../uni_modules/uview-plus/components/u-toast/u-toast.js"))();const t={__name:"login",setup(t){const a=o.useUserStore(),u=e.ref({username:"",password:""}),n=e.ref(null),r=function(){e.index.navigateTo({url:"/pages/register/register"})},l=async function(){let o=await s._post("/1.1/login",u.value);if(200===o.statusCode){n.value.show({message:"登录成功!",duration:1e3,complete(){e.index.navigateTo({url:"/pages/home/home"})}});let s={username:o.data.username,token:o.data.sessionToken};a.saveUserInfo(s)}else n.value.show({message:210===o.data.code?"用户密码错误!":"用户不存在!",duration:1e3})};return(s,o)=>({a:u.value.username,b:e.o((e=>u.value.username=e.detail.value)),c:u.value.password,d:e.o((e=>u.value.password=e.detail.value)),e:e.o(l),f:e.p({text:"点击登录"}),g:e.o(r),h:e.sr(n,"3d535461-1",{k:"uToastRef"})})}};wx.createPage(t);
