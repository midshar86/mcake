"use strict";const e=require("../../common/vendor.js"),u=require("../../store/user.js"),o=require("../../store/cart.js"),l=require("../../store/settleList.js");if(!Array){(e.resolveComponent("up-rate")+e.resolveComponent("up-dropdown-item")+e.resolveComponent("up-dropdown")+e.resolveComponent("up-number-box")+e.resolveComponent("up-button")+e.resolveComponent("up-toast"))()}Math||((()=>"../../uni_modules/uview-plus/components/u-rate/u-rate.js")+(()=>"../../uni_modules/uview-plus/components/u-dropdown-item/u-dropdown-item.js")+(()=>"../../uni_modules/uview-plus/components/u-dropdown/u-dropdown.js")+(()=>"../../uni_modules/uview-plus/components/u-number-box/u-number-box.js")+(()=>"../../uni_modules/uview-plus/components/u-button/u-button.js")+(()=>"../../uni_modules/uview-plus/components/u-toast/u-toast.js"))();const t={__name:"detail",setup(t){const a=e.ref("选择尺寸"),n=e.ref("选择场景"),s=e.ref(""),i=u.useUserStore(),r=o.useCartStore(),v=l.useSettleStore(),d=e.ref(null),p=e.ref(""),c=e.ref(1),m=e.ref([]),b=e.ref([{label:"生日快乐",value:"生日快乐"},{label:"永远幸福",value:"永远幸福"},{label:"开开心心",value:"开开心心"},{label:"快快乐乐",value:"快快乐乐"},{label:"Happy Birthday",value:"Happy Birthday"},{label:"自定义",value:"自定义"}]),f=e.ref(null),g=e.ref("");e.onLoad((u=>{e.index.request({url:`https://www.mcake.com/api/goods/detail?cityId=110&warehouse_id=0&id=0&sku=${u.sku}&show=0`,success(e){var u;f.value=e.data.data,null==(u=f.value.list)||u.forEach((e=>{m.value.push({label:e.spec+" "+e.weight,value:e.spec+" "+e.weight})}))},fail(e){console.log(e)}}),g.value=u.target})),e.onMounted((()=>{let u=setTimeout((()=>{g.value&&e.index.pageScrollTo({scrollTop:500,duration:400}),clearTimeout(u)}),400)}));const w=function(e){a.value=e},h=function(e){n.value=e},j=function(){e.index.navigateBack()},x=function(){d.value.show({message:"未登录!即将跳转至登录页面...",duration:1e3,complete(){e.index.navigateTo({url:"/pages/login/login"})}})},C=function(){i.isLogin?p.value?(r.addToCart(f.value,p.value,c.value),d.value.show({message:"加入购物车成功!",duration:800})):d.value.show({message:"请选择商品规格",duration:1e3}):x()},_=function(){};return e.watch(a,(()=>{var e,u,o;p.value=null==(u=null==(e=f.value)?void 0:e.list)?void 0:u.filter((e=>a.value===e.spec+" "+e.weight)),s.value=null==(o=p.value)?void 0:o[0].describe}),{immediate:!0}),(u,o)=>{var l,t,r,g,y,T,S;return{a:e.o(j),b:e.f(null==(l=f.value)?void 0:l.banner,((e,u,o)=>({a:e,b:e}))),c:e.t(null==(t=f.value)?void 0:t.name),d:e.t(null==(r=f.value)?void 0:r.french),e:e.t(null==(g=f.value)?void 0:g.price),f:e.f(null==(y=f.value)?void 0:y.basic,((u,o,l)=>e.e({a:e.t(u.chinese),b:3!==o},3!==o?{c:e.t(u.value)}:{d:"d0d1b126-0-"+l,e:e.p({count:5,gutter:"0",modelValue:u.value,readonly:!0})},{f:u.id,g:3===o?1:""}))),g:e.f(null==(T=f.value)?void 0:T.mater,((u,o,l)=>({a:e.t(u.name),b:u.id}))),h:e.o(w),i:e.p({options:m.value,title:a.value}),j:e.o(h),k:e.p({options:b.value,title:n.value}),l:e.o(_),m:e.o((e=>c.value=e)),n:e.p({buttonSize:"20",bgColor:"lightblue",modelValue:c.value}),o:e.t(s.value),p:e.o((u=>{var o;return function(u,o){if(i.isLogin)if(p.value){let l={img:u.img,name:u.name,price:u.price,describe:u.describe,buyNum:o};v.addSettleList([l]),console.log(v.$state.goodsList),e.index.navigateTo({url:"/pages/settleAccounts/settleAccounts"})}else d.value.show({message:"请选择商品规格",duration:1e3});else x()}(null==(o=p.value)?void 0:o[0],c.value)})),q:e.p({text:"立即结算",color:"#001111"}),r:e.o(C),s:e.p({text:"加入购物袋"}),t:e.f(null==(S=f.value)?void 0:S.pcImg,((e,u,o)=>({a:e,b:e}))),v:e.sr(d,"d0d1b126-8",{k:"uToastRef"})}}}};wx.createPage(t);
