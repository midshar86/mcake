"use strict";const e=require("../../common/vendor.js"),a=require("../../store/user.js"),s=require("../../utils/req.js");if(!Array){(e.resolveComponent("header-comp")+e.resolveComponent("item-comp")+e.resolveComponent("up-toast"))()}Math||(o+(()=>"../../uni_modules/uview-plus/components/u-toast/u-toast.js"))();const o=()=>"../../components/navBar.js",t={__name:"index",setup(o){const t=e.ref([]),r=e.ref(0),u=e.ref(""),l=e.ref(null),n=e.ref(!1),i=e.ref([]),v=e.ref(""),d=a.useUserStore(),c=function(){s._get(`/1.1/classes/goods?where=${u.value}&limit=8&skip=${8*r.value}`).then((e=>{if(!e.data.results.length)return l.value.show({message:"没有更多了..."}),!1;t.value=[...t.value,...e.data.results],r.value++}))},g=function(e){n.value=e};return e.onLoad((a=>{e.index.getStorage({key:"classList",success(e){i.value=JSON.parse(e.data)}}),v.value=a.bid,u.value=JSON.stringify({bigId:a.bid}),c()})),e.onReachBottom((()=>{c()})),e.onPullDownRefresh((()=>{r.value=0,t.value=[],c(),e.index.stopPullDownRefresh()})),(a,s)=>({a:e.o(g),b:e.p({show:n.value,list:i.value,bid:v.value}),c:e.o((e=>n.value=!0)),d:e.f(t.value,((a,s,o)=>({a:a.img,b:e.o((s=>{return o=a,void e.index.navigateTo({url:`/pages/detail/detail?sku=${o.sku}`});var o})),c:e.o((s=>{return o=a,void(d.isLogin?(console.log(o),e.index.navigateTo({url:`/pages/detail/detail?sku=${o.sku}&target=true`})):l.value.show({message:"用户未登录",duration:1e3,complete(){e.index.navigateTo({url:"/pages/login/login"})}}));var o})),d:"6adafb73-2-"+o,e:e.p({src:a.cartImg,title:a.name,price:a.price})}))),e:e.sr(l,"6adafb73-3",{k:"uToastRef"})})}};wx.createPage(t);
