"use strict";const e=require("../../common/vendor.js"),u=require("../../common/assets.js"),o=require("../../store/cart.js"),t=require("../../store/user.js"),l=require("../../store/settleList.js");if(!Array){(e.resolveComponent("up-icon")+e.resolveComponent("up-number-box")+e.resolveComponent("up-modal")+e.resolveComponent("up-toast"))()}Math||((()=>"../../uni_modules/uview-plus/components/u-icon/u-icon.js")+(()=>"../../uni_modules/uview-plus/components/u-number-box/u-number-box.js")+(()=>"../../uni_modules/uview-plus/components/u-modal/u-modal.js")+(()=>"../../uni_modules/uview-plus/components/u-toast/u-toast.js"))();const a={__name:"cart",setup(a){const n=o.useCartStore(),s=t.useUserStore(),i=l.useSettleStore(),r=e.ref(n.cartData),c=e.ref(!1),v=e.ref(!1),m=e.ref(!1),d=e.ref(null),p=e.ref(!1),f=e.ref(""),b=e.ref(0),h=e.ref(""),g=function(){e.index.navigateBack()},k=function(){v.value=!v.value},w=function(){c.value=!1},x=function(){n.addBuyNum(f.value,h.value),n.changeSpec(f.value,b.value);let e=setTimeout((()=>{b.value=0,clearTimeout(e)}),400);c.value=!1},C=function(){m.value=n.checkAll,n.changeEveryCheckState(!m.value)},y=function(e){h.value=e.value},j=e.computed((()=>{let e=0;return r.value.forEach((u=>{u.isCheck&&(e+=u.buyNum*Number(u.list[u.subListIdx].price))})),e})),N=function(){e.index.navigateTo({url:"/pages/login/login"})},L=function(){e.index.navigateBack()},S=function(){let u=r.value.filter((e=>e.isCheck)),o=[];u.forEach((e=>{o.push({...e.list[e.subListIdx],buyNum:e.buyNum})})),console.log(o),i.addSettleList(o),o.length?e.index.navigateTo({url:"/pages/settleAccounts/settleAccounts"}):d.value.show({message:"未选择结算商品!",duration:2e3,type:"error",iconUrl:"https://cdn.uviewui.com/uview/demo/toast/error.png"})};return e.onLoad((()=>{s.isLogin||(p.value=!0)})),(o,t)=>e.e({a:e.o(g),b:e.p({name:"arrow-left"}),c:e.f(r.value,((u,o,t)=>({a:e.n({check:u.isCheck}),b:e.o((e=>function(e){n.changeCheckState(e)}(o)),`${u.id}-${u.goodsId}`),c:"547bc966-1-"+t,d:u.img,e:e.t(u.name),f:e.t(u.french),g:e.t(r.value[o].buyNum*Number(r.value[o].list[r.value[o].subListIdx].price)),h:e.o((e=>{return u=o,f.value=u,b.value=r.value[f.value].subListIdx,c.value=!0,void(h.value=r.value[f.value].buyNum);var u}),`${u.id}-${u.goodsId}`),i:"547bc966-2-"+t,j:e.t(r.value[o].list[r.value[o].subListIdx].spec),k:e.t(r.value[o].buyNum),l:`${u.id}-${u.goodsId}`}))),d:e.p({name:"checkmark-circle-fill"}),e:e.p({name:"edit-pen"}),f:e.n({check:e.unref(n).checkAll}),g:e.o(C),h:e.p({name:"checkmark-circle-fill"}),i:e.t(j.value),j:e.o(S),k:u._imports_0,l:e.t(r.value[f.value].name),m:e.t(r.value[f.value].french),n:e.t(h.value*Number(r.value[f.value].list[b.value].price)),o:e.t(r.value[f.value].list[b.value].spec),p:e.t(r.value[f.value].list[b.value].edible),q:e.p({name:"arrow-down"}),r:v.value},v.value?{s:e.f(r.value[f.value].list,((u,o,t)=>({a:e.t(u.spec),b:e.t(u.edible),c:u.id,d:e.o((e=>function(e){b.value=e,v.value=!1}(o)),u.id)})))}:{},{t:e.o(k),v:e.o(y),w:e.p({iconStyle:"backgroundColor:orange",modelValue:r.value[f.value].buyNum}),x:e.o((e=>c.value=!1)),y:e.o(x),z:e.o(w),A:e.p({show:c.value,showConfirmButton:!1,closeOnClickOverlay:!0,width:"80vw"}),B:e.o(N),C:e.o(L),D:e.p({show:p.value,title:"温馨提示",showCancelButton:!0,contentTextAlign:"center",confirmText:"登录"}),E:e.sr(d,"547bc966-8",{k:"uToastRef"}),F:e.o((e=>v.value=!1))})}};wx.createPage(a);
